(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a(61)},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),c=a(27),r=a.n(c),o=a(3),i=a(4),l=a.n(i),m=a(29),d="http://118.126.108.36",u="ws://118.126.108.36",g=(a(59),a(9)),h=a(10),p=a(12),f=a(11),v=a(13),y=a(7),E=a.n(y),w=(a(60),a(1)),N=a(6),_=a(30),b=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.length},k={location:"",isLogin:!1,user:{},isVerify:!0,address:[],shopCar:[]},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(w.a)({},e,{isLogin:!b(t.payload),user:b(t.payload)?{}:t.payload,isVerify:!1});case"SET_ROUTER_LOCATION":return Object(w.a)({},e,{location:t.payload});case"SET_SHOP_CAR":return Object(w.a)({},e,{shopCar:t.payload});case"SET_ADDRESS":return Object(w.a)({},e,{address:t.payload});default:return e}},A=a(15),O={contacts:[],messagesNotRead:[],chatnow:void 0,messages:[],sendingMessages:[],hideWindow:!0,hideChat:!0},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_CHAT_MESSAGE_BACK":return Object(w.a)({},e,{messages:e.messages.map(function(e){return e.userId!==t.payload.target?e:Object(w.a)({},e,{content:[].concat(Object(A.a)(e.content),[{sender:t.payload.origin,msg:t.payload.content}])})}),sendingMessages:e.sendingMessages.filter(function(e){return e.target!==t.payload.target})});case"PUT_SENDING_MESSAGE":return Object(w.a)({},e,{sendingMessages:[].concat(Object(A.a)(e.sendingMessages),[{target:e.chatnow,message:t.payload}])});case"RECEIVE_CHAT_MESSAGE":var a=e.messagesNotRead.find(function(e){return e.userId===t.payload.origin});if(a)return Object(w.a)({},e,{messagesNotRead:e.messagesNotRead.map(function(e){return e.userId===t.payload.origin?Object(w.a)({},e,{notRead:e.notRead+1,content:[].concat(Object(A.a)(e.content),[{sender:t.payload.origin,msg:t.payload.content}])}):e})});if(a=e.messages.find(function(e){return e.userId===t.payload.origin})){if(a.userId===e.chatnow)return Object(w.a)({},e,{messages:e.messages.map(function(e){return e.userId===t.payload.origin?Object(w.a)({},e,{content:Array.isArray(e.content)?e.content.concat([{sender:t.payload.origin,msg:t.payload.content}]):[{sender:t.payload.origin,msg:t.payload.content}]}):e})});var n=[{sender:t.payload.origin,msg:t.payload.content}];return Object(w.a)({},e,{messages:e.messages.filter(function(e){return e.userId!==t.payload.origin}),messagesNotRead:[Object(w.a)({},a,{content:Array.isArray(a.content)?a.content.concat(n):n,notRead:1})].concat(e.messagesNotRead)})}return Object(w.a)({},e,{messagesNotRead:[{userId:t.payload.origin,nickname:t.payload.nickname,avatar:t.payload.avatar,notRead:1,content:[{sender:t.payload.origin,msg:t.payload.content}]}].concat(e.messagesNotRead)});case"INIT_CONTACTS":for(var s=[],c=[],r=0,o=t.payload.length;r<o;r++)t.payload[r].notRead>0?c.push(t.payload[r]):s.push(t.payload[r]);return Object(w.a)({},e,{messagesNotRead:c,messages:s});case"MESSAGE_NOT_READ_ITEM_TO_CHAT":return Object(w.a)({},e,{chatnow:t.payload.userId,messagesNotRead:e.messagesNotRead.filter(function(e){return e.userId!==t.payload.userId}),messages:[t.payload].concat(e.messages),hideWindow:!1});case"CONTACT_ITEM_TO_CHAT":var i=Object(w.a)({},e,{chatnow:t.payload.userId,hideWindow:!1,hideChat:!1,messagesNotRead:e.messagesNotRead.filter(function(e){var a=e.userId!==t.payload.userId;return a||(t.payload.content=e.content),a}),messages:e.messages.filter(function(e){var a=e.userId!==t.payload.userId;return a||(t.payload.content=e.content),a})});return i.messagesNotRead.length!==e.messagesNotRead.length||i.messages.length!==e.messages.length?Object(w.a)({},i,{messages:[t.payload].concat(i.messages)}):(t.payload.content=[],Object(w.a)({},i,{messages:[t.payload].concat(e.messages)}));case"MESSAGE_ITEM_TO_CHAT":return Object(w.a)({},e,{chatnow:t.payload.userId,hideWindow:!1});case"SET_CONTACTS":return Object(w.a)({},e,{contacts:t.payload});case"SET_WAIT_MESSAGE":return Object(w.a)({},e,{messages:e.messages.map(function(a){return a.userId===e.chatnow?Object(w.a)({},a,{wait:t.payload}):a})});case"TOGGLE_CHAT":return Object(w.a)({},e,{hideChat:t.payload});case"SWING_CHAT_WINDOW":return Object(w.a)({},e,{hideWindow:t.payload});case"LOGIN_OUT_CHAT":return O;default:return e}},C=Object(N.c)({auth:T,chat:I}),S=[_.a],j={};if("object"===typeof window){var M=window.localStorage.getItem("localStoreState");if(M)try{j=JSON.parse(M)}catch(me){console.error(me)}}var x=[N.a.apply(void 0,S)];"object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&x.push(window.__REDUX_DEVTOOLS_EXTENSION__());var R=Object(N.e)(C,j,N.d.apply(void 0,x)),W=function(e){e?(l.a.defaults.headers.common.Authorization=e,window.localStorage.setItem("jwtToken",e),"close"===L.status&&L.initSocket(e)):(delete l.a.defaults.headers.common.Authorization,window.localStorage.removeItem("jwtToken"))},H=function(e){b(e)&&("open"===L.status&&L.ws.close(),R.dispatch({type:"LOGIN_OUT_CHAT"})),R.dispatch({type:"SET_CURRENT_USER",payload:e})},D=u,G={status:"close",ws:null,initSocket:function(e){if("object"===typeof window&&e){var t=new WebSocket("".concat(D,"?token=").concat(e));t.onopen=function(e){console.log("socket open"),G.status="open",setInterval(function(){"open"===G.status&&t.send(JSON.stringify({type:"transToken",target:"koa"}))},9e5),t.send('{"type":"init_chat_messages"}')},t.onmessage=function(e){var t=e.data;try{t=JSON.parse(t)}catch(me){return}switch(t.type){case"transToken":return W(t.content);case"send_chat_message":return J(t);case"init_chat_messages":return B(t.content);case"receive_chat_message":return P(t);case"get_contacts":return z(t.content);default:return}},t.onclose=function(e){console.log("socket close!"),G.status="close"},t.onerror=function(e){console.error("socket error",e)},G.ws=t}}},L=G,B=function(e){R.dispatch({type:"INIT_CONTACTS",payload:e})},U=function(e){e=Object(w.a)({},e,{userId:e.userId||e.contactId});var t=R.getState().chat;(t.chatnow!==e.userId||t.hideChat)&&R.dispatch({type:"CONTACT_ITEM_TO_CHAT",payload:e})},J=function(e){R.dispatch({type:"SEND_CHAT_MESSAGE_BACK",payload:e})},P=function(e){e.origin===R.getState().chat.chatnow&&"open"===L.status&&L.ws.send(JSON.stringify({type:"msg_be_read",content:e.origin})),R.dispatch({type:"RECEIVE_CHAT_MESSAGE",payload:e})},z=function(e){R.dispatch({type:"SET_CONTACTS",payload:e})},V=d;function K(e){var t=e.replace(/{{=\w+\.(jpg|png|icon|gif|jpeg)}}/g,"\u3010\u56fe\u7247\u3011").replace("&lt;","<").replace("&gt;",">");return e.length<19?t:t.substring(0,18)+"..."}var X=Object(o.b)(function(e){return{messagesNotRead:Array.isArray(e.chat.messagesNotRead)?e.chat.messagesNotRead:[],messages:Array.isArray(e.chat.messages)?e.chat.messages:[],chatnow:e.chat.chatnow}},{messageNotReadItemToChatAction:function(e){return function(t){return function(){"open"===L.status&&L.ws.send(JSON.stringify({type:"msg_be_read",content:e.userId})),t({type:"MESSAGE_NOT_READ_ITEM_TO_CHAT",payload:e})}}},messageItemToChatAction:function(e){return function(t){return function(){t({type:"MESSAGE_ITEM_TO_CHAT",payload:e})}}}})(function(e){return s.a.createElement("div",{className:"chat-msg-wrap"},[e.messagesNotRead.map(function(t,a){return s.a.createElement("div",{onClick:e.messageNotReadItemToChatAction(t),key:a,className:E()("msg-item",{"msg-item-select":t.userId===e.chatnow})},s.a.createElement("div",{className:"msg-i-userwrap"},s.a.createElement("div",{className:"msg-i-avatar",style:{background:"url(".concat(V,"/image/member/avatar/").concat(t.avatar,") center center / 35px 35px no-repeat")}}),s.a.createElement("div",{className:"msg-i-nickname"},t.nickname)),s.a.createElement("div",{className:"msg-i-wrap"},s.a.createElement("div",{className:"msg-i-disone"},Array.isArray(t.content)&&t.content.length>0?K(t.content[t.content.length-1].msg):""),s.a.createElement("div",{className:"msg-i-len"},t.notRead)),s.a.createElement("div",{className:"msg-i-time"},Array.isArray(t.content)&&t.content.length>0?function(e,t){var a=new Date(e);return Number.isNaN(a.getDay())?"":(t?a.getFullYear()+"-":"")+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()}(t.content[t.content.length-1].creaTime):""))}),e.messages.map(function(t,a){return s.a.createElement("div",{onClick:e.messageItemToChatAction(t),key:a,className:E()("msg-item",{"msg-item-select":t.userId===e.chatnow})},s.a.createElement("div",{className:"msg-i-userwrap"},s.a.createElement("div",{className:"msg-i-avatar",style:{background:"url(".concat(V,"/image/member/avatar/").concat(t.avatar,") center center / 35px 35px no-repeat")}}),s.a.createElement("div",{className:"msg-i-nickname"},t.nickname)),s.a.createElement("div",{className:"msg-i-wrap"},s.a.createElement("div",{className:"msg-i-disone"},e.chatnow!==t.userId&&t.wait?K(t.wait):Array.isArray(t.content)&&t.content.length>0?K(t.content[t.content.length-1].msg):"")))})])}),$=d;function F(e){return function(){U(e)}}var Y=Object(o.b)(function(e){return{contacts:Array.isArray(e.chat.contacts)?e.chat.contacts:[]}})(function(e){"open"===L.status&&L.ws.send(JSON.stringify({type:"get_contacts"}));var t=[],a=[];return e.contacts.forEach(function(e){e.isOnline?t.push(e):a.push(e)}),s.a.createElement("div",null,e.contacts.length<1?s.a.createElement("div",null,"\u4f60\u8fd8\u6ca1\u6709\u8054\u7cfb\u4eba\u54e6..."):[t.map(function(e,t){return s.a.createElement("div",{key:t,onClick:F(e),className:"chat-contact-item"},s.a.createElement("div",{className:"chatcon-il"},s.a.createElement("img",{src:"".concat($,"/image/member/avatar/").concat(e.avatar)})),s.a.createElement("p",{title:e.nickname,className:"chatcon-ir"},e.nickname))}),a.map(function(e,t){return s.a.createElement("div",{key:t,onClick:F(e),className:"chat-contact-item chat-item-offline"},s.a.createElement("div",{className:"chatcon-il"},s.a.createElement("img",{src:"".concat($,"/image/member/avatar/").concat(e.avatar)})),s.a.createElement("p",{title:e.nickname,className:"chatcon-ir"},e.nickname))})])}),q=a(5),Q=d,Z=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={searchAns:[],keyword:"",message:""},a.shakeGetAns=a.shakeGetAns().bind(Object(q.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"shakeGetAns",value:function(){var e=-1;return function(t){var a=this;clearTimeout(e),e=setTimeout(function(){a.setState({message:"\u641c\u7d22\u4e2d..."}),l.a.get("".concat(Q,"/api/users/search_contacts?keyword=").concat(a.state.keyword)).then(function(e){e.data.success&&a.setState({searchAns:e.data.payload,message:0===e.data.payload.length?"\u672a\u641c\u7d22\u5230\u8054\u7cfb\u4eba...":""})}).catch(function(e){console.error(e)})},1e3)}}},{key:"keywordChange",value:function(e){var t=this,a=e.target.value;this.setState({keyword:a},function(){t.shakeGetAns(a)})}},{key:"contactsClick",value:function(e){U(e)}},{key:"addContactsClick",value:function(e){return function(t){t.stopPropagation(),"open"===L.status&&(L.ws.send(JSON.stringify({type:"add_contacts",content:e.userId})),this.setState({searchAns:this.state.searchAns.filter(function(t){return t.userId!==e.userId})}))}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"chat-search-wrap"},s.a.createElement("div",{className:"chat-s-input"},s.a.createElement("div",{className:"chat-s-i-l"},s.a.createElement("input",{value:this.state.keyword,placeholder:"\u8f93\u5165\u8054\u7cfb\u4eba\u6635\u79f0",onChange:this.keywordChange.bind(this),type:"text"})),s.a.createElement("div",{className:"chat-s-i-r"},"\u70b9\u51fb\u641c\u7d22")),s.a.createElement("div",{className:"chat-s-ans"},Array.isArray(this.state.searchAns)&&0===this.state.searchAns.length?s.a.createElement("div",{className:"con-search-miss"},this.state.message):this.state.searchAns.map(function(t,a){return s.a.createElement("div",{onClick:e.contactsClick.bind(e,t),className:"c-s-item",key:a},s.a.createElement("div",{className:"c-s-i-avatar"},s.a.createElement("img",{src:"".concat(Q,"/image/member/avatar/").concat(t.avatar)})),s.a.createElement("div",{className:"c-s-i-nickname"},t.nickname),s.a.createElement("div",{onClick:e.addContactsClick(t).bind(e),className:"c-s-i-btn-add"},"\u52a0\u597d\u53cb"))})))}}]),t}(s.a.Component),ee=d;function te(e){if(""===e||"string"!==typeof e)return e;var t=e.match(/[A-z0-9]{10}_\d{8}\.(jpg|jpeg|gif|png|ico)(?=}})/g);if(t){var a=e.split(/{{\=[A-z0-9]{10}_\d{8}\.[jpgenifco]{3,4}}}/i);e=a[0];for(var n=1,s=a.length;n<s;n++)e+='<img chat="'.concat(t[n-1],'" src="').concat(ee,"/image/member/chat/").concat(/\.gif$/.test(t[n-1])?t[n-1]:t[n-1]+"_w80.jpg",'">').concat(a[n])}return e}var ae=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={hasError:!1,message:"",showChatImage:!1,chatImage:""},a.scrollToButton=a.scrollToButton.bind(Object(q.a)(a)),a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentDidCatch",value:function(e,t){}},{key:"componentDidMount",value:function(){if("object"===typeof window){this.refs.textarea.ondragenter=function(e){e.preventDefault()},this.refs.textarea.ondragleave=function(e){e.preventDefault()},this.refs.textarea.ondragover=function(e){e.preventDefault()};var e=this;this.refs.textarea.ondrop=function(t){if(t.preventDefault(),t.stopPropagation(),e.props.chat.chatnow){var a=t.dataTransfer.files[0];if(a&&!(a.size>"5048576\u202c")&&/^image\/(jpeg|png|gif|x-icon)$/.test(a.type)){var n=new FormData;n.append("picture",a),l.a.post("".concat(ee,"/api/users/save_chat_image"),n).then(function(t){t.data.success?e.props.setWaitMessageAction(e.refs.textarea.innerHTML+='<img src="'.concat(ee,"/image/member/chat/").concat(t.data.payload,'_w80.jpg">')):console.log(t)}).catch(function(e){console.error(e)})}}},document.getElementsByClassName("chatw-show-wrap")[0].onclick=function(t){var a=t.target.getAttribute("chat");a&&/^\w{10}_\d{7,9}\.(jpg|jpeg|png|icon)$/.test(a)&&(console.log(a),e.setState({showChatImage:!0,chatImage:a}))}}}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&(this.refs.textarea.ondragenter=null,this.refs.textarea.ondragleave=null,this.refs.textarea.ondragover=null,this.refs.textarea.ondrop=null)}},{key:"componentWillReceiveProps",value:function(e,t){if("object"===typeof window){var a=this.props.chat;if(a.chatnow!==e.chat.chatnow){var n=e.chat.messages.find(function(t){return t.userId===e.chat.chatnow});n&&n.wait?this.refs.textarea.innerHTML=n.wait:this.refs.textarea.innerText="",this.scrollToButton()}else{var s=a.messages.find(function(e){return e.userId===a.chatnow}),c=e.chat.messages.find(function(t){return t.userId===e.chat.chatnow});s&&c&&Array.isArray(s.content)&&Array.isArray(c.content)&&s.content.length!==c.content.length&&this.scrollToButton()}this.refs.textarea.focus()}}},{key:"scrollToButton",value:function(){var e=this;setTimeout(function(){e.refs.chatMessageBox.scrollTop=e.refs.chatMessageBox.scrollHeight,setTimeout(function(){e.refs.chatMessageBox.scrollTop=e.refs.chatMessageBox.scrollHeight},200)},100)}},{key:"closeChatImage",value:function(){this.setState({showChatImage:!1,chatImage:""})}},{key:"swingChatWindow",value:function(){this.props.swingChatWindowAction(!0)}},{key:"sendMessage",value:function(){var e=this.refs.textarea.innerHTML.trim();if(""!==e&&this.props.chat.chatnow){var t=e.match(/[A-z0-9]{10}_\d{8}\.(gif|png|jpg|jpeg|ico)(?=_w80\.jpg")/g);if(t){var a=e.split(/<img [\w\W]+>/);e=a[0];for(var n=1,s=a.length;n<s;n++)e+="{{=".concat(t[n-1],"}}").concat(a[n])}if(""!==(e=e.replace(/<(span|font|div|br|img)[\d\D]*?>/g,"").replace(/<\/(div|span|font)>/g,"").replace(/&nbsp;/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;"))){if("open"!==L.status)return this.setState({messages:"\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5"});this.props.sendingMessageAction(e),L.ws.send(JSON.stringify({type:"send_chat_message",origin:this.props.user.userId,target:this.props.chat.chatnow,content:e})),this.refs.textarea.innerText="",this.props.setWaitMessageAction("")}}}},{key:"textareaInput",value:function(e){this.props.setWaitMessageAction(e.target.innerHTML.trim().replace(/<div><br><\/div>/g,""))}},{key:"textareaPress",value:function(e){var t=e.target.innerHTML;"Enter"===e.key&&(e.target.innerHTML=t.replace(/<div><br><\/div>$/g,""),this.sendMessage())}},{key:"render",value:function(){var e=this,t=this.props.chat,a=void 0;return t.chatnow&&Array.isArray(t.messages)&&(a=t.messages.find(function(e){return e.userId===t.chatnow})),s.a.createElement("div",{className:"chat-window",style:{display:t.hideWindow?"none":"block"}},s.a.createElement("div",{className:"chatw-header"},s.a.createElement("div",{onClick:this.swingChatWindow.bind(this),className:"charw-hide",style:{background:"url(".concat(ee,"/image/ui/left.png) center center / 25px 25px no-repeat #628ef9")}}),s.a.createElement("div",{className:"chatw-h-targetname"},a&&a.nickname)),s.a.createElement("div",{className:"chatw-show-scroll-wrap"},s.a.createElement("div",{ref:"chatMessageBox",className:"chatw-show-wrap"},[a&&a.content.map(function(t,n){return s.a.createElement("div",{className:"chat-chatnow-wrap",key:n},t.sender===a.userId?s.a.createElement("div",{className:"chat-target-wrap"},s.a.createElement("div",{className:"chat-target",key:"1"},s.a.createElement("div",{className:"chat-ta-avatar",style:{background:"url(".concat(ee,"/image/member/avatar/").concat(a.avatar,") center center / 30px 30px no-repeat")}}),s.a.createElement("div",{className:"chat-ta-nickname"},a.nickname)),s.a.createElement("div",{className:"chat-msg-target",dangerouslySetInnerHTML:{__html:te(t.msg)},key:"2"})):s.a.createElement("div",{className:"chat-me-wrap"},s.a.createElement("div",{className:"chat-me",key:"1"},s.a.createElement("div",{className:"chat-me-avatar",style:{background:"url(".concat(ee,"/image/member/avatar/").concat(e.props.user.avatar,") center center / 30px 30px no-repeat")}}),s.a.createElement("div",{className:"chat-me-nickname"},e.props.user.nickname)),s.a.createElement("div",{className:"chat-msg-me",dangerouslySetInnerHTML:{__html:te(t.msg)},key:"2"})))}),a&&t.sendingMessages.map(function(t,n){return t.target!==a.userId?null:s.a.createElement("div",{className:"chat-chatnow-wrap",key:n},s.a.createElement("div",{className:"chat-me-wrap"},s.a.createElement("div",{className:"chat-me",key:"1"},s.a.createElement("div",{className:"chat-me-avatar",style:{background:"url(".concat(ee,"/image/member/avatar/").concat(e.props.user.avatar,") center center / 30px 30px no-repeat")}}),s.a.createElement("div",{className:"chat-me-nickname"},e.props.user.nickname)),s.a.createElement("div",{className:"wait-msg-box"},s.a.createElement("div",{className:"chat-msg-me",dangerouslySetInnerHTML:{__html:te(t.message)},key:"2"}),s.a.createElement("div",{className:"wait-logo"}))))})])),s.a.createElement("div",{className:"chatw-send-wrap"},s.a.createElement("div",{className:"chatw-s-textarea"},s.a.createElement("div",{id:"textarea",ref:"textarea",onInput:this.textareaInput.bind(this),contentEditable:!!a,suppressContentEditableWarning:"true",onKeyPress:this.textareaPress.bind(this),dangerouslySetInnerHTML:{__html:this.state.message}})),s.a.createElement("div",{className:"chatw-s-sendbox"},this.state.message&&s.a.createElement("div",{className:"char-err"},this.state.message),s.a.createElement("div",{onClick:this.sendMessage.bind(this),className:"chatw-s-sendbtn"},"\u53d1\u9001"))),this.state.showChatImage&&s.a.createElement("div",{onClick:this.closeChatImage.bind(this),className:"chat-img-wrap"},s.a.createElement("img",{src:"".concat(ee,"/image/member/chat/").concat(this.state.chatImage)})))}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(s.a.Component);var ne=Object(o.b)(function(e){return{user:e.auth.user,chat:e.chat}},{swingChatWindowAction:function(e){return function(t){t({type:"SWING_CHAT_WINDOW",payload:e})}},setWaitMessageAction:function(e){return function(t){t({type:"SET_WAIT_MESSAGE",payload:e})}},sendingMessageAction:function(e){return function(t){t({type:"PUT_SENDING_MESSAGE",payload:e})}}})(ae),se=d,ce=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={route:"message",message:""},a}return Object(v.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){}},{key:"routeChange",value:function(e){this.setState({route:e})}},{key:"render",value:function(){return s.a.createElement("div",{id:"chat",style:{width:this.props.hideWindow?"280px":"600px"}},s.a.createElement("div",{className:"chat-route"},s.a.createElement("div",{id:"chat-move",className:"cr-user-wrap"},s.a.createElement("div",{className:"cr-user-avatar",style:{background:"url(".concat(se,"/image/member/avatar/").concat(this.props.auth.user.avatar,") center center / 30px 30px no-repeat")}}),s.a.createElement("div",{className:"cr-user-name"},this.props.auth.user.nickname)),s.a.createElement("div",{className:"cr-routes-wrap"},s.a.createElement("div",{onClick:this.routeChange.bind(this,"message"),className:E()("crr-item",{"crr-select-bg":"message"===this.state.route})},s.a.createElement("div",{className:"crr-item-img"},s.a.createElement("img",{src:"".concat(se,"/image/ui/message.png")})),s.a.createElement("div",{className:"crr-item-f"},s.a.createElement("span",null,"\u6d88\u606f"))),s.a.createElement("div",{onClick:this.routeChange.bind(this,"contacts"),className:E()("crr-item",{"crr-select-bg":"contacts"===this.state.route})},s.a.createElement("div",{className:"crr-item-img"},s.a.createElement("img",{src:"".concat(se,"/image/ui/user.png")})),s.a.createElement("div",{className:"crr-item-f"},s.a.createElement("span",null,"\u8054\u7cfb\u4eba"))),s.a.createElement("div",{onClick:this.routeChange.bind(this,"search"),className:E()("crr-item",{"crr-select-bg":"search"===this.state.route})},s.a.createElement("div",{className:"crr-item-img"},s.a.createElement("img",{src:"".concat(se,"/image/ui/monitor.png")})),s.a.createElement("div",{className:"crr-item-f"},s.a.createElement("span",null,"\u627e\u4eba"))))),s.a.createElement("div",{className:"chat-body"},s.a.createElement("div",{className:"chat-body-box"},this.props.auth.isLogin?"message"===this.state.route?s.a.createElement(X,null):"contacts"===this.state.route?s.a.createElement(Y,null):"search"===this.state.route?s.a.createElement(Z,null):null:s.a.createElement("div",{className:"warning-info"},"\u8bf7\u767b\u5f55\u540e\u64cd\u4f5c\uff01"))),s.a.createElement(ne,null))}}]),t}(s.a.Component);var re=Object(o.b)(function(e){return{auth:e.auth,hideWindow:e.chat.hideWindow}},{initContacts:B})(ce);if("object"===typeof window){var oe;if(window.__INITIAL_TOKEN__)try{var ie=window.__INITIAL_TOKEN__.split(".");oe=1e3*JSON.parse(m.Base64.decode(ie[1])).exp>Date.now()?window.__INITIAL_TOKEN__:window.localStorage.jwtToken}catch(me){console.error("tokenValidError",me.message),oe=window.localStorage.jwtToken}oe&&(l.a.defaults.headers.common.Authorization=oe,l.a.get("".concat(d,"/api/users/current")).then(function(e){e.data.success?(W(e.data.payload.token),H(e.data.payload.user)):(W(!1),H({}))}).catch(function(e){W(!1),H({})}))}var le=function(e){return s.a.createElement(re,null)};r.a.render(s.a.createElement(function(){return s.a.createElement(o.a,{store:R},s.a.createElement(le,null))},null),document.getElementById("react-body"))}},[[31,1,2]]]);
//# sourceMappingURL=main.cee87c3a.chunk.js.map